<?php

namespace Fobia\DataBase\Query;

/**
 * Generated by PHPUnit_SkeletonGenerator 1.2.1 on 2014-07-24 at 06:56:20.
 */
class QueryInsertTest extends \PHPUnit_Framework_TestCase
{

    /**
     * @var \Fobia\DataBase\Handler\MySQL
     */
    protected $db;

    protected function setUp()
    {
        if ( ! $this->db) {
            $this->db = \Fobia\DataBase\DbFactory::create('mysql://root@localhost/mysql');
        }
    }

    public function testInsertIntoIgnore()
    {
        $q = $this->db->createInsertQuery();
        $this->assertInstanceOf('\Fobia\DataBase\Query\QueryInsert', $q);
        $q->insertIntoIgnore('user');
        $q->set("Host", "'localhost'");

        $stmt = $q->prepare();
        $this->assertStringStartsWith("INSERT IGNORE INTO user", $stmt->queryString);
    }

    public function testGetQuery()
    {
        $q = $this->db->createInsertQuery();

        $str = "INSERT INTO user ( Host, User, Password ) VALUES ( 'localhost', 'test', '' )";
        $q->insertInto('user')
                ->set('Host', $this->db->quote('localhost'))
                ->set('User', $this->db->quote('test'))
                ->set('Password', $this->db->quote(''));
        $this->assertEquals($str, $q->getQuery());
    }
}